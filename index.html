<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>–ú–∞—Ç—Ä–∏—Ü–∞ –≠–π–∑–µ–Ω—Ö–∞—É—ç—Ä–∞</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">

<style>
:root{
--bg:#0f1220;
--glass:rgba(255,255,255,.08);
--border:rgba(255,255,255,.15);
--text:#fff;
--accent:#6c63ff;
}

*{box-sizing:border-box}

body{
margin:0;
font-family:Inter,sans-serif;
background:linear-gradient(135deg,#1a1f3c,#0f1220);
color:var(--text);
display:flex;
flex-direction:column;
height:100vh;
}

header{
text-align:center;
padding:14px;
font-size:22px;
font-weight:600;
}

/* BOARD */
.board{
flex:1;
display:grid;
grid-template-columns:1fr 1fr;
grid-template-rows:1fr 1fr;
gap:12px;
padding:12px;
}

.quadrant{
background:var(--glass);
border:1px solid var(--border);
border-radius:16px;
padding:12px;
overflow-y:auto;
}

.q1 h2{color:#ff6b6b}
.q2 h2{color:#4dabff}
.q3 h2{color:#ffd166}
.q4 h2{color:#6ee7b7}

h2{
margin:0 0 8px;
font-size:15px;
font-weight:600;
}

/* NOTE */
.note{
background:#fff9c4;
color:#222;
padding:10px;
border-radius:12px;
margin-bottom:8px;
cursor:pointer;
}

.note.active{
outline:2px solid #ff6b6b;
}

.note-time{
font-size:12px;
opacity:.7;
margin-top:4px;
}

.tags{
display:flex;
flex-wrap:wrap;
gap:4px;
margin-top:4px;
}

.tag{
background:#222;
color:#fff;
font-size:11px;
padding:2px 6px;
border-radius:6px;
}

/* MODAL */
.modal{
position:fixed;
inset:0;
background:rgba(0,0,0,.6);
display:none;
align-items:center;
justify-content:center;
}

.modal-content{
background:#1a1f3c;
padding:16px;
width:340px;
border-radius:14px;
border:1px solid var(--border);
}

label{
font-size:12px;
opacity:.8;
display:block;
margin-top:8px;
}

textarea,input{
width:100%;
padding:8px;
border-radius:8px;
border:none;
font-family:inherit;
margin-top:4px;
}

.actions{
display:flex;
gap:8px;
margin-top:12px;
}

button{
flex:1;
padding:8px;
border:none;
border-radius:8px;
cursor:pointer;
}

.save{background:var(--accent);color:#fff}
.delete{background:#ff6b6b;color:#fff}

/* POMODORO */
.pomodoro{
border-top:1px solid var(--border);
padding:10px;
display:grid;
grid-template-columns:1fr 1fr 1fr auto;
gap:8px;
align-items:end;
}

.timer{
grid-column:1/5;
text-align:center;
font-size:22px;
font-weight:600;
margin-top:4px;
}

.pomo-btn{
background:var(--accent);
color:#fff;
}

/* MOBILE */
@media(max-width:768px){
.board{grid-template-columns:1fr}
.pomodoro{grid-template-columns:1fr}
.timer{grid-column:auto}
}
</style>
</head>
<body>

<header>–ú–∞—Ç—Ä–∏—Ü–∞ –≠–π–∑–µ–Ω—Ö–∞—É—ç—Ä–∞</header>

<div class="board">
<div class="quadrant q1"><h2>–í–∞–∂–Ω–æ ¬∑ –°—Ä–æ—á–Ω–æ</h2></div>
<div class="quadrant q2"><h2>–í–∞–∂–Ω–æ ¬∑ –ù–µ —Å—Ä–æ—á–Ω–æ</h2></div>
<div class="quadrant q3"><h2>–ù–µ –≤–∞–∂–Ω–æ ¬∑ –°—Ä–æ—á–Ω–æ</h2></div>
<div class="quadrant q4"><h2>–ù–µ –≤–∞–∂–Ω–æ ¬∑ –ù–µ —Å—Ä–æ—á–Ω–æ</h2></div>
</div>

<!-- MODAL -->
<div class="modal" id="modal">
<div class="modal-content">
<label>–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏</label>
<textarea id="taskText"></textarea>

<label>–°—Ä–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è</label>
<input type="datetime-local" id="taskDeadline">

<label>–¢–µ–≥–∏ (—á–µ—Ä–µ–∑ # –∏–ª–∏ –∑–∞–ø—è—Ç—É—é)</label>
<input id="taskTags">

<label>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –∑–∞–¥–∞—á–µ</label>
<textarea id="taskComment" placeholder="–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏, –º—ã—Å–ª–∏, —Å—Å—ã–ª–∫–∏‚Ä¶"></textarea>

<div class="actions">
<button class="save" onclick="saveTask()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
<button class="delete" onclick="deleteTask()">–£–¥–∞–ª–∏—Ç—å</button>
</div>
</div>
</div>

<!-- POMODORO -->
<div class="pomodoro">
<div>
<label>–ó–∞–¥–∞—á–∞</label>
<select id="pomoTask"></select>
</div>
<div>
<label>–†–∞–±–æ—Ç–∞ (–º–∏–Ω)</label>
<input type="number" id="workTime" value="25">
</div>
<div>
<label>–û—Ç–¥—ã—Ö (–º–∏–Ω)</label>
<input type="number" id="restTime" value="5">
</div>
<button class="pomo-btn" onclick="startPomodoro()">‚ñ∂</button>
<div class="timer" id="timer">üçÖ 25:00</div>
</div>

<script>
let activeQuadrant=null, editingNote=null, activeTask=null;
let timerInterval, remaining=0, mode='work';

const beep=new Audio("data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEAESsAACJWAAACABAAZGF0YQAAAAA=");

document.querySelectorAll('.quadrant').forEach(q=>{
q.onclick=e=>{
if(e.target.closest('.note')) return;
activeQuadrant=q;
openModal(null);
};
});

function openModal(note){
editingNote=note;
modal.style.display='flex';
taskText.value=note?.dataset.text||'';
taskDeadline.value=note?.dataset.deadline||'';
taskTags.value=note?.dataset.tags||'';
taskComment.value=note?.dataset.comment||'';
}

function saveTask(){
let note=editingNote||document.createElement('div');
note.className='note';

note.dataset.text=taskText.value;
note.dataset.deadline=taskDeadline.value;
note.dataset.tags=taskTags.value;
note.dataset.comment=taskComment.value;

note.innerHTML=`
<div>${taskText.value}</div>
${taskDeadline.value?`<div class="note-time">üìÖ ${new Date(taskDeadline.value).toLocaleString()}</div>`:''}
<div class="tags">${renderTags(taskTags.value)}</div>
`;

note.onclick=e=>{
e.stopPropagation();
selectTask(note);
openModal(note);
};

if(!editingNote) activeQuadrant.appendChild(note);
updatePomodoroTasks();
closeModal();
}

function deleteTask(){
if(editingNote) editingNote.remove();
updatePomodoroTasks();
closeModal();
}

function renderTags(str){
return str.split(/[,#]/).filter(t=>t.trim()).map(t=>`<span class="tag">#${t.trim()}</span>`).join('');
}

function closeModal(){
modal.style.display='none';
editingNote=null;
}

function updatePomodoroTasks(){
pomoTask.innerHTML='<option value="">‚Äî –≤—ã–±–µ—Ä–∏ –∑–∞–¥–∞—á—É ‚Äî</option>';
document.querySelectorAll('.note').forEach((n,i)=>{
pomoTask.innerHTML+=`<option value="${i}">${n.dataset.text}</option>`;
});
}

function selectTask(note){
document.querySelectorAll('.note').forEach(n=>n.classList.remove('active'));
note.classList.add('active');
activeTask=note;
}

function startPomodoro(){
clearInterval(timerInterval);
mode='work';
remaining=workTime.value*60;
tick();
timerInterval=setInterval(()=>{
remaining--;
tick();
if(remaining<=0){
beep.play();
mode=mode==='work'?'rest':'work';
remaining=(mode==='work'?workTime.value:restTime.value)*60;
}
},1000);
}

function tick(){
let m=String(Math.floor(remaining/60)).padStart(2,'0');
let s=String(remaining%60).padStart(2,'0');
timer.textContent=`${mode==='work'?'üçÖ':'üí§'} ${m}:${s}`;
}
</script>

</body>
</html>
