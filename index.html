<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Матрица Эйзенхауэра</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#0d1020;
  --panel:#1b1f2e;
  --text:#f5f6fa;
  --muted:#9aa0b5;
  --accent:#6f7dff;
}

*{box-sizing:border-box;margin:0;padding:0;font-family:Inter,sans-serif;}

body{
  min-height:100vh;
  background:
    linear-gradient(rgba(255,255,255,.04) 1px, transparent 1px),
    linear-gradient(90deg, rgba(255,255,255,.04) 1px, transparent 1px),
    var(--bg);
  background-size:40px 40px;
  color:var(--text);
}

header{
  text-align:center;
  padding:18px;
  font-size:26px;
  font-weight:700;
  color:var(--accent);
}

/* === MATRIX === */
.board{
  padding:14px;
  display:grid;
  grid-template-columns:1fr 1fr;
  grid-template-rows:auto auto;
  gap:12px;
}

@media (max-width:720px){
  .board{
    grid-template-columns:1fr;
  }
}

.quadrant{
  position:relative;
  background:linear-gradient(180deg,#1e2334,#191d2b);
  border-radius:22px;
  padding:16px 18px 18px 22px;
  box-shadow:0 10px 24px rgba(0,0,0,.45);
  min-height:160px;
}

.quadrant::before{
  content:'';
  position:absolute;
  left:0;top:0;bottom:0;width:5px;
  border-radius:22px 0 0 22px;
}

.q1::before{background:#ff6b6b;}
.q2::before{background:#4dabff;}
.q3::before{background:#ffd666;}
.q4::before{background:#6ee7b7;}

h2{font-size:14px;font-weight:600;margin-bottom:10px;}

.tasks{
  display:flex;
  flex-direction:column;
  gap:8px;
}

/* unlimited tasks */
.task{
  padding:10px 12px;
  border-radius:12px;
  font-size:13px;
  cursor:pointer;
  transition:.25s;
  user-select:none;
}

.task.q1{background:#ff6b6b;}
.task.q2{background:#4dabff;}
.task.q3{background:#ffd666;color:#222;}
.task.q4{background:#6ee7b7;color:#222;}

.task small{
  display:block;
  font-size:11px;
  opacity:.75;
  margin-top:4px;
}

.task.done{
  opacity:.35;
  text-decoration:line-through;
  filter:grayscale(1);
}

/* === POMODORO === */
.pomodoro{
  margin:14px;
  padding:18px;
  background:linear-gradient(180deg,#1e2334,#191d2b);
  border-radius:22px;
}

.timer{
  text-align:center;
  font-size:44px;
  font-weight:700;
  margin:16px 0;
}

.pomo-grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:12px;
}

label{font-size:12px;color:var(--muted);}

input{
  width:100%;
  padding:10px 12px;
  border-radius:12px;
  border:none;
  background:#0f1324;
  color:white;
}

.mode-buttons,.buttons{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:10px;
  margin-top:10px;
}

.buttons{grid-template-columns:1fr 1fr 1fr;}

button{
  padding:12px;
  border-radius:14px;
  border:none;
  font-weight:600;
  cursor:pointer;
  color:white;
}

.primary{background:linear-gradient(135deg,#6f7dff,#7f8cff);}
.secondary{background:linear-gradient(135deg,#4a4f6a,#5c6280);}
button.active{outline:2px solid var(--accent);}

/* === MODAL === */
#modal{
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.7);
  z-index:100;
  justify-content:center;
  align-items:center;
}

#modalContent{
  background:var(--panel);
  padding:20px;
  border-radius:16px;
  width:90%;
  max-width:400px;
}

#modal input,#modal textarea{
  width:100%;
  padding:10px;
  margin-bottom:12px;
  border-radius:10px;
  background:#0f1324;
  color:white;
  border:none;
}
</style>
</head>

<body>

<header>Матрица Эйзенхауэра</header>

<div class="board">
  <div class="quadrant q1" data-id="q1"><h2>Важно · Срочно</h2><div class="tasks" ondrop="drop(event)" ondragover="allowDrop(event)"></div></div>
  <div class="quadrant q2" data-id="q2"><h2>Важно · Не срочно</h2><div class="tasks" ondrop="drop(event)" ondragover="allowDrop(event)"></div></div>
  <div class="quadrant q3" data-id="q3"><h2>Не важно · Срочно</h2><div class="tasks" ondrop="drop(event)" ondragover="allowDrop(event)"></div></div>
  <div class="quadrant q4" data-id="q4"><h2>Не важно · Не срочно</h2><div class="tasks" ondrop="drop(event)" ondragover="allowDrop(event)"></div></div>
</div>

<div class="pomodoro">
  <div class="pomo-grid">
    <div><label>Работа (мин)</label><input id="workInput" type="number" value="25"></div>
    <div><label>Отдых (мин)</label><input id="breakInput" type="number" value="5"></div>
  </div>

  <div id="timer" class="timer">25:00</div>

  <div class="mode-buttons">
    <button id="workBtn" class="secondary active">Работа</button>
    <button id="breakBtn" class="secondary">Отдых</button>
  </div>

  <div class="buttons">
    <button id="startBtn" class="primary">Старт</button>
    <button id="pauseBtn" class="secondary">Пауза</button>
    <button id="resetBtn" class="secondary">Сбросить</button>
  </div>
</div>

<!-- Modal -->
<div id="modal">
  <div id="modalContent">
    <h3 id="modalTitle">Новая задача</h3>
    <input id="taskTitle" placeholder="Название задачи">
    <textarea id="taskComment" rows="3" placeholder="Комментарий"></textarea>
    <button id="saveTaskBtn" class="primary">Сохранить</button>
    <button id="cancelTaskBtn" class="secondary">Отмена</button>
  </div>
</div>

<script>
let tasks=JSON.parse(localStorage.getItem('eisenhowerTasks'))||{};
let currentQuadrantId=null;
let editingTaskId=null;

function saveTasks(){localStorage.setItem('eisenhowerTasks',JSON.stringify(tasks));}

function renderTasks(){
  document.querySelectorAll('.tasks').forEach(t=>t.innerHTML='');
  for(const [qid,list] of Object.entries(tasks)){
    const c=document.querySelector(`.quadrant[data-id="${qid}"] .tasks`);
    if(!c)continue;
    list.forEach(task=>{
      const el=document.createElement('div');
      el.className=`task ${qid}`+(task.done?' done':'');
      el.draggable=true;
      el.innerHTML=`${task.title}${task.comment?`<small>${task.comment}</small>`:''}`;
      el.onclick=()=>{task.done=!task.done;saveTasks();renderTasks();}
      el.ondblclick=e=>{e.stopPropagation();editTask(qid,task.id);}
      el.ondragstart=e=>e.dataTransfer.setData('text',JSON.stringify({id:task.id,from:qid}));
      c.appendChild(el);
    });
  }
}

function editTask(q,id){
  const t=tasks[q].find(x=>x.id===id);
  currentQuadrantId=q;editingTaskId=id;
  taskTitle.value=t.title;taskComment.value=t.comment||'';
  modal.style.display='flex';
}

document.querySelectorAll('.quadrant').forEach(q=>{
  q.querySelector('.tasks').onclick=e=>{
    if(e.target.closest('.task'))return;
    currentQuadrantId=q.dataset.id;editingTaskId=null;
    taskTitle.value='';taskComment.value='';
    modal.style.display='flex';
  }
});

saveTaskBtn.onclick=()=>{
  const title=taskTitle.value.trim();
  if(!title)return alert('Введите название');
  if(editingTaskId){
    const t=tasks[currentQuadrantId].find(x=>x.id===editingTaskId);
    t.title=title;t.comment=taskComment.value;
  }else{
    tasks[currentQuadrantId]??=[];
    tasks[currentQuadrantId].push({id:Date.now()+'' ,title,comment:taskComment.value,done:false});
  }
  modal.style.display='none';
  saveTasks();renderTasks();
};

cancelTaskBtn.onclick=()=>modal.style.display='none';
modal.onclick=e=>{if(e.target===modal)modal.style.display='none';};

function allowDrop(e){e.preventDefault();}
function drop(e){
  e.preventDefault();
  const d=JSON.parse(e.dataTransfer.getData('text'));
  const to=e.currentTarget.closest('.quadrant').dataset.id;
  if(d.from===to)return;
  const t=tasks[d.from].splice(tasks[d.from].findIndex(x=>x.id===d.id),1)[0];
  tasks[to]??=[];tasks[to].push(t);
  saveTasks();renderTasks();
}

renderTasks();
</script>

</body>
</html>
